<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Wake — Secure Download</title>
  <style>
    :root { color-scheme: dark; }
    body { font-family: system-ui, sans-serif; background:#0b0b0b; color:#eaeaea; margin:0; display:grid; place-items:center; min-height:100vh; }
    .box { max-width: 640px; padding: 32px; border:1px solid #222; border-radius: 12px; background:#111; }
    h1 { margin:0 0 8px; font-size: 22px; }
    p { opacity: .9; line-height: 1.5; }
    .btn { display:inline-block; margin-top:16px; padding:12px 18px; border:1px solid #2a6fdd; border-radius:8px; text-decoration:none; color:#fff; }
    .btn:hover { background:#2a6fdd22; }
    .muted { opacity:.7; font-size: 14px; }
  </style>
</head>
<body>
  <div class="box">
    <h1 id="title">Preparing your download…</h1>
    <p id="desc">This link is time-limited for security.</p>
    <a id="cta" class="btn" href="#" style="display:none">Download</a>
    <p class="muted" id="meta"></p>
  </div>

<script>
/** CONFIG — A adapter **/
const ASSET_URL = "https://github.com/ORG/REPO/releases/download/v1.0.0/wake-1.0.0.zip";
const EXPIRY_ISO = "2025-11-05T23:59:59Z";   // date/heure d’expiration (UTC)
const AUTO_REDIRECT = true;                  // true = rediriger sans clic
const SHOW_BUTTON_BEFORE_REDIRECT = false;   // true = afficher bouton avant redirection

/** LOGIQUE **/
const expiry = new Date(EXPIRY_ISO).getTime();
const now = Date.now();
const title = document.getElementById("title");
const desc  = document.getElementById("desc");
const cta   = document.getElementById("cta");
const meta  = document.getElementById("meta");

function formatTime(t){
  return new Date(t).toLocaleString(undefined, {hour12:false});
}

if (isNaN(expiry)) {
  title.textContent = "Config error";
  desc.textContent  = "Invalid EXPIRY_ISO format.";
} else if (now <= expiry) {
  title.textContent = "Download ready";
  desc.textContent  = "Your secure link is valid.";
  cta.href = ASSET_URL;
  if (SHOW_BUTTON_BEFORE_REDIRECT || !AUTO_REDIRECT) {
    cta.style.display = "inline-block";
  }
  meta.textContent = "Expires on: " + formatTime(expiry);
  if (AUTO_REDIRECT) {
    // petit délai pour que la page s’affiche
    setTimeout(()=>{ location.href = ASSET_URL; }, 600);
  }
} else {
  title.textContent = "Link expired";
  desc.innerHTML = "This link is no longer valid. <br/>Please request a new one.";
  meta.textContent = "Expired on: " + formatTime(expiry);
}
</script>
</body>
</html>
