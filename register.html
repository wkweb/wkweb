<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <title>Wake JIT Engine — Preview & Early Access</title>
  <meta name="description" content="Preview of Wake JIT Engine. Join Early Access to get updates and private access as releases roll out."/>

  <!-- Fonts + Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600&display=swap">

  <script defer src="version.js"></script>

  <style>
    :root { --wake-blue:#0066CC; }
    body { font-family:'Inter',sans-serif; background:#000; color:#EAEAEA; }
    .mono { font-family:'JetBrains Mono',monospace; }
    .wake-blue { color: var(--wake-blue); }
    .bg-wake-blue { background-color: var(--wake-blue); }
    .hover-bg-wake-blue:hover { background-color:#0055AA; }
    .title-outline {
      text-shadow:
        -2px -2px 0 #000, 2px -2px 0 #000,
        -2px  2px 0 #000, 2px  2px 0 #000;
    }
    .glass-card{
      background:rgba(0,0,0,.35);
      border:1px solid var(--wake-blue);
      backdrop-filter: blur(6px);
      transition: all .25s ease;
    }
    .glass-card:hover{ transform:translateY(-3px); box-shadow:0 0 18px rgba(0,102,204,.25); background:rgba(0,0,0,.45); }
    #console-strip{
      border-bottom:1px solid #0b0b0b;
      background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,.25));
    }
    .muted{ color:#a9a9a9; }
    .small-note{ color:#9aa0a6; font-size:.85rem; }
    .input-dark{
      background:#0b0b0b; border:1px solid #1f2937; color:#EAEAEA;
    }
    .input-dark:focus{
      outline:none; border-color:var(--wake-blue); box-shadow:0 0 0 2px rgba(0,102,204,.25);
    }
    .status{ font-weight:600; margin-top:.5rem; }
    .status.ok{ color:#25d366; }
    .status.err{ color:#ff6b6b; }
    .hp{ position:absolute; left:-5000px; opacity:0; }
    .badge {
      display:inline-flex; align-items:center; gap:.5rem;
      border:1px solid #0f2439; background:#0B0B0B;
      padding:.4rem .7rem; border-radius:.6rem; font-size:.85rem;
    }
    .dot { width:.5rem; height:.5rem; border-radius:9999px; background:var(--wake-blue); }

    /* Effet couleur progressif uniquement pour la version */
    .aurora-text {
      background: linear-gradient(90deg, #3aa0ff, #64d4ff, #3aa0ff);
      background-size: 200% 100%;
      -webkit-background-clip: text;
              background-clip: text;
      color: transparent;
      animation: aurora-move 2.4s linear infinite;
    }
    @keyframes aurora-move {
      0%   { background-position:   0% 50%; }
      100% { background-position: 200% 50%; }
    }
    section.min-h-\[30vh\] {
     padding-bottom: 2.0rem !important;
   }

  </style>
</head>
<body class="min-h-screen">

  <!-- Console header -->
  <header id="console-strip" class="w-full">
    <div class="max-w-5xl mx-auto px-4 py-3 text-sm mono text-gray-300">
      &gt; Wake Runtime — Preview Console
      <span class="text-gray-500"> // preview active — waiting for Early Access registrations...</span>
    </div>
  </header>

  <!-- Hero -->
  <section class="min-h-[30vh] flex flex-col justify-center items-center text-center px-4 py-14">
    <h1 class="mono text-4xl md:text-6xl font-bold mb-3">
      <a href="index.html" class="hover:opacity-80 transition duration-200">
        <span class="wake-blue title-outline">WAKE</span>
        <span class="title-outline">JIT ENGINE</span>
      </a>
    </h1>

    <!-- Current version badge -->
    <div class="badge mono mb-5" aria-label="Current version">
    
      <span>Current version:</span>
      <!-- Seule la version a l'effet couleur progressif -->
      <strong class="aurora-text">Wake Alpha Preview v0.1</strong>
    </div>

    <!-- Texte punchy en 3 lignes (exact) -->
    <p class="text-lg md:text-xl max-w-2xl muted">
      <span class="block">You’re about to enter the <span class="text-white font-semibold">Wake Alpha Preview</span></span>
      <span class="block">The first live JIT engine experience</span><br>
      <span class="block">Enter your email below to step inside and unlock <span class="text-white font-semibold">Early Access
    </p>
  </section>

  <!-- Early Access Form -->
  <main class="px-4 pb-24">
    <div class="max-w-xl mx-auto glass-card rounded-xl p-6 md:p-8">
      <h2 class="mono text-2xl font-bold mb-2">Request Early Access</h2>
      <p class="muted mb-6">
        Join the Early Access list to receive invites, release notes, and the private link when the build goes live.
      </p>

      <form id="wakeForm" action="/subscribe" method="post" novalidate>
        <label for="email" class="block font-semibold mb-2">Email</label>
        <input id="email" name="email" type="email" autocomplete="email"
               placeholder="you@company.com" required
               class="input-dark w-full rounded-lg px-4 py-3 mb-4"/>

        <div class="flex items-start gap-3 mb-1">
          <input id="consent" name="consent" type="checkbox" required class="mt-[6px]">
          <label for="consent" class="font-normal text-sm muted">
            I agree to receive Early Access invitations and updates from Wake.
          </label>
        </div>

        <!-- Honeypot anti-bot -->
        <div aria-hidden="true" class="hp">
          <label for="website">Your website</label>
          <input id="website" name="website" type="text" tabindex="-1" autocomplete="off"/>
        </div>

        <!-- Optional Turnstile -->
        <div id="turnstile-box" class="mt-3"></div>

        <button id="submitBtn" type="submit" disabled
                class="mt-5 inline-flex items-center justify-center bg-wake-blue hover-bg-wake-blue text-white font-semibold px-5 py-3 rounded-lg transition opacity-50 cursor-not-allowed">
          Join Early Access
        </button>

        <div id="status" class="status" role="status" aria-live="polite"></div>

        <p class="small-note mt-3">
          No spam, no trackers. Unsubscribe anytime.
        </p>

        <noscript class="text-red-400 mt-2 block">
          JavaScript is disabled. The form will still submit, but you won’t see inline messages.
        </noscript>
      </form>
    </div>

    <!-- Footer -->
    <footer class="text-center mt-10">
      <p class="text-sm muted">
        © <span id="y"></span> Majify Technologies — Wake Preview & Early Access.
      </p>
    </footer>
  </main>

  <script>
  (function(){
    // While your Worker is only on workers.dev:
    const ACTION_URL = "https://wake-ea.waketools-dev.workers.dev/subscribe";
    // After routing on your domain, switch to: const ACTION_URL = "/subscribe";
    const TURNSTILE_SITE_KEY = "";

    document.getElementById('y').textContent = new Date().getFullYear();
    const form = document.getElementById('wakeForm');
    const btn  = document.getElementById('submitBtn');
    const consent = document.getElementById('consent');
    const statusEl = document.getElementById('status');
    form.action = ACTION_URL;

    if (TURNSTILE_SITE_KEY) {
      const s = document.createElement('script');
      s.src = "https://challenges.cloudflare.com/turnstile/v0/api.js";
      s.async = true; s.defer = true;
      document.head.appendChild(s);
      const box = document.getElementById('turnstile-box');
      const div = document.createElement('div');
      div.className = 'cf-turnstile';
      div.setAttribute('data-sitekey', TURNSTILE_SITE_KEY);
      box.appendChild(div);
    }

    function updateButtonState() {
      if (consent.checked) {
        btn.disabled = false;
        btn.classList.remove('opacity-50','cursor-not-allowed');
      } else {
        btn.disabled = true;
        btn.classList.add('opacity-50','cursor-not-allowed');
      }
    }
    consent.addEventListener('change', updateButtonState);
    updateButtonState();

    function setStatus(msg, ok){
      statusEl.textContent = msg || '';
      statusEl.className = 'status ' + (ok===true ? 'ok' : ok===false ? 'err' : '');
    }

    form.addEventListener('submit', async (e) => {
      if (window.fetch) {
        e.preventDefault();
        setStatus('');
        if (!form.email.value || !form.email.checkValidity()) {
          setStatus('Enter a valid email.', false); return;
        }
        if (!form.consent.checked) {
          setStatus('Please confirm consent.', false); return;
        }
        if (form.website.value) { setStatus('Blocked (bot detected).', false); return; }

        btn.disabled = true;
        btn.textContent = 'Sending…';
        btn.classList.add('opacity-50','cursor-not-allowed');

        try {
          const payload = { email: form.email.value.trim(), consent: true };
          const tsField = form.querySelector('input[name="cf-turnstile-response"]');
          if (tsField && tsField.value) payload["cf-turnstile-response"] = tsField.value;

          const res = await fetch(form.action, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });

          let ok = res.ok;
          let msg = 'You’re now registered for the Wake Early Access preview.';
          const ct = res.headers.get('content-type') || '';
          if (ct.includes('application/json')) {
            const data = await res.json().catch(()=>({}));
            ok = ('ok' in data) ? !!data.ok : res.ok;
            msg = (data.message || msg);
          }
          if (ok) {
            setStatus(msg, true);
            form.reset();
            updateButtonState();
          } else {
            setStatus(msg || 'Error. Please try again.', false);
          }
        } catch(err){
          setStatus('Network error. Please try again.', false);
        } finally {
          btn.textContent = 'Join Early Access';
          updateButtonState();
        }
      }
    });
  })();
  </script>
</body>
</html>
